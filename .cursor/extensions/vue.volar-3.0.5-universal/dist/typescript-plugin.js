"use strict";const e=require(`./path-browserify-RqgFuIaq.js`),t=require(`./language-core-gQQEUcbM.js`);var n=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.makeGetExternalFiles=exports.decoratedLanguageServiceHosts=exports.decoratedLanguageServices=exports.projectExternalFileExtensions=exports.externalFiles=void 0,exports.makeGetScriptInfoWithLargeFileFailsafe=a,exports.createLanguageCommon=o,exports.isHasAlreadyDecoratedLanguageService=l;let n=t.require_language_core$1(),r=t.require_common(),i=t.require_decorateLanguageServiceHost();exports.externalFiles=new WeakMap,exports.projectExternalFileExtensions=new WeakMap,exports.decoratedLanguageServices=new WeakSet,exports.decoratedLanguageServiceHosts=new WeakSet;function a(e){return t=>{try{return e.project.getScriptInfo(t)}catch{}}}function o(e,t,o,s){let c=o.languageServiceHost.getScriptSnapshot.bind(o.languageServiceHost),l=a(o),u=(0,n.createLanguage)([...e.languagePlugins,{getLanguageId:r.resolveFileLanguageId}],new n.FileMap(t.sys.useCaseSensitiveFileNames),(e,t,n)=>{let r;n?r=c(e):(r=l(e)?.getSnapshot(),r||(o.project.getScriptVersion(e),r=l(e)?.getSnapshot())),r?u.scripts.set(e,r):u.scripts.delete(e)},e=>{o.session.change({file:e,line:1,offset:1,endLine:1,endOffset:1,insertString:``})});s(u),(0,i.decorateLanguageServiceHost)(t,u,o.languageServiceHost),e.setup?.(u)}let s=t=>(n,r=0)=>{if(r>=1||!exports.externalFiles.has(n)){let r=exports.externalFiles.get(n),a=exports.projectExternalFileExtensions.get(n),o=a?.length?(0,i.searchExternalFiles)(t,n,a):[];exports.externalFiles.set(n,o),r&&!c(r,o)&&n.refreshDiagnostics()}return exports.externalFiles.get(n)};exports.makeGetExternalFiles=s;function c(e,t){if(e.length!==t.length)return!1;let n=new Set(e);for(let e of t)if(!n.has(e))return!1;return!0}function l(t){return exports.decoratedLanguageServices.has(t.languageService)||exports.decoratedLanguageServiceHosts.has(t.languageServiceHost)?!0:(exports.decoratedLanguageServices.add(t.languageService),exports.decoratedLanguageServiceHosts.add(t.languageServiceHost),!1)}}),r=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.createLanguageServicePlugin=a;let r=t.require_proxyLanguageService(),i=n();function a(e){return t=>{let{typescript:n}=t,a={create(t){if(!(0,i.isHasAlreadyDecoratedLanguageService)(t)){let a=e(n,t),o=a.languagePlugins.map(e=>e.typescript?.extraFileExtensions.map(e=>`.`+e.extension)??[]).flat();i.projectExternalFileExtensions.set(t.project,o);let{proxy:s,initialize:c}=(0,r.createProxyLanguageService)(t.languageService);t.languageService=s,(0,i.createLanguageCommon)(a,n,t,c)}return t.languageService},getExternalFiles:(0,i.makeGetExternalFiles)(n)};return a}}}),i=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.createVueLanguageServiceProxy=a;let n=t.require_language_core(),r=t.require_shared(),i=/\\/g;function a(e,t,n,r){let i=new Map,a=(i,a)=>{switch(a){case`getCompletionsAtPosition`:return o(e,t,r,i[a]);case`getCompletionEntryDetails`:return s(t,i[a]);case`getCodeFixesAtPosition`:return c(i[a]);case`getDefinitionAndBoundSpan`:return l(e,t,n,r,i[a])}};return new Proxy(n,{get(e,t,n){if(a){i.has(t)||i.set(t,a(e,t));let n=i.get(t);if(n)return n}return Reflect.get(e,t,n)},set(e,t,n,r){return Reflect.set(e,t,n,r)}})}function o(e,t,a,o){return(s,c,l,u)=>{let d=s.replace(i,`/`),f=o(d,c,l,u);if(f){f.entries=f.entries.filter(e=>!e.name.includes(`__VLS_`)&&!e.labelDetails?.description?.includes(`__VLS_`));let i=t.scripts.get(d),o=i?.generated?.root;if(o instanceof n.VueVirtualCode){let t=[o.sfc.template,...o.sfc.styles],n=t.filter(Boolean).map(e=>[e.startTagEnd,e.endTagStart]);if(n.some(([e,t])=>c>=e&&c<=t)){let t=new Set([`var`,`function`,`module`]),n=e.Completions.SortText.GlobalsOrKeywords,i=new Set([n,`z`+n,n+`1`]);f.entries=f.entries.filter(e=>!(e.kind===`const`&&e.name in a.macros)&&(!t.has(e.kind)||!i.has(e.sortText)||(0,r.isGloballyAllowed)(e.name)))}}for(let e of f.entries)if(e.source){let t=e.name;for(let n of a.extensions){let i=(0,r.capitalize)(n.slice(1));if(e.source.endsWith(n)&&e.name.endsWith(i)){e.name=(0,r.capitalize)(e.name.slice(0,-i.length)),e.insertText&&=e.insertText.replace(`${i}$1`,`$1`),e.data&&(e.data.__isComponentAutoImport={ext:n,suffix:i,originalName:t,newName:e.insertText});break}}e.data&&(e.data.__isAutoImport={fileName:d})}}return f}}function s(e,t){return(...r)=>{let i=t(...r);if(r[6]?.__isComponentAutoImport){let{originalName:e,newName:t}=r[6].__isComponentAutoImport;for(let n of i?.codeActions??[])for(let r of n.changes)for(let n of r.textChanges)n.newText=n.newText.replace(`import `+e+` from `,`import `+t+` from `)}if(r[6]?.__isAutoImport){let{fileName:t}=r[6].__isAutoImport,a=e.scripts.get(t);if(a?.generated?.root instanceof n.VueVirtualCode){let e=a.generated.root.vueSfc;if(!e?.descriptor.script&&!e?.descriptor.scriptSetup)for(let e of i?.codeActions??[]){for(let t of e.changes){for(let e of t.textChanges){e.newText=`<script setup lang="ts">${e.newText}</script>\n\n`;break}break}break}}}return i}}function c(e){return(...t)=>{let n=e(...t);return n=n.filter(e=>!e.description.includes(`__VLS_`)),n}}function l(e,t,r,i,a){return(o,s)=>{let c=a(o,s);if(!c?.definitions?.length)return c;let l=r.getProgram(),u=t.scripts.get(o);if(!u?.generated)return c;let d=u.generated.root;if(!(d instanceof n.VueVirtualCode)||!d.sfc.template||s<d.sfc.template.startTagEnd||s>d.sfc.template.endTagStart)return c;let f=new Set(c.definitions),p=[];if(c.definitions.length>=2)for(let e of c.definitions)(d.sfc.content[e.textSpan.start-1]===`@`||d.sfc.content.slice(e.textSpan.start-5,e.textSpan.start)===`v-on:`)&&p.push(e);for(let e of c.definitions){if(i.extensions.some(t=>e.fileName.endsWith(t)))continue;let t=l.getSourceFile(e.fileName);if(!t)continue;m(t,e,t)}for(let e of p)f.delete(e);return{definitions:[...f],textSpan:c.textSpan};function m(t,n,r){e.isPropertySignature(t)&&t.type||e.isVariableDeclaration(t)&&e.isIdentifier(t.name)&&t.type&&!t.initializer?h(t.name,t.type,n,r):e.forEachChild(t,e=>m(e,n,r))}function h(t,n,r,i){let{textSpan:o,fileName:s}=r,c=t.getStart(i),l=t.getEnd();if(c!==o.start||l-c!==o.length||!e.isIndexedAccessTypeNode(n))return;let u=n.indexType.getStart(i),d=a(s,u);if(d?.definitions?.length){for(let e of d.definitions)f.add(e);p.push(r)}}}}}),a=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.collectExtractProps=r;let n=t.require_language_core();function r(e,t){let{typescript:r,languageService:i,language:a}=this,o=a.scripts.get(e),s=o?.generated?.root;if(!o?.generated||!(s instanceof n.VueVirtualCode))return[];let c=new Map,l=i.getProgram(),u=l.getSourceFile(e),d=l.getTypeChecker(),f=o.generated.languagePlugin.typescript?.getServiceScript(s),p=f?[...a.maps.forEach(f.code)].map(([,e])=>e):[],{sfc:m}=s;return u.forEachChild(function e(i){if(r.isPropertyAccessExpression(i)&&r.isIdentifier(i.expression)&&i.expression.text===`__VLS_ctx`&&r.isIdentifier(i.name)){let{name:e}=i;for(let a of p){let s=!1;for(let l of a.toSourceLocation(e.getEnd()-o.snapshot.getLength()))if(l[0]>=m.template.startTagEnd+t[0]&&l[0]<=m.template.startTagEnd+t[1]&&(0,n.isSemanticTokensEnabled)(l[1].data)){if(s=!0,!c.has(e.text)){let t=d.getTypeAtLocation(i),n=d.typeToString(t,i,r.TypeFormatFlags.NoTruncation);c.set(e.text,{name:e.text,type:n.includes(`__VLS_`)?`any`:n,model:!1})}let t=r.isPostfixUnaryExpression(i.parent)||r.isBinaryExpression(i.parent);t&&(c.get(e.text).model=!0);break}if(s)break}}i.forEachChild(e)}),[...c.values()]}}),o=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.getComponentType=a,exports.getSelfComponentName=o,exports.getVariableType=s;let r=t.require_shared(),i=e.require_path_browserify();function a(e,t,n,i,a,c){let l=t.getProgram(),u=l.getTypeChecker(),d=c.split(`.`),f=i.type.getProperty(d[0])??i.type.getProperty((0,r.camelize)(d[0]))??i.type.getProperty((0,r.capitalize)((0,r.camelize)(d[0]))),p;if(f){p=u.getTypeOfSymbolAtLocation(f,i.node);for(let e=1;e<d.length;e++)f=p.getProperty(d[e]),f&&(p=u.getTypeOfSymbolAtLocation(f,i.node))}else{let i=o(a);i===(0,r.capitalize)((0,r.camelize)(c))&&(p=s(e,t,n,`__VLS_self`)?.type)}return p}function o(e){let t=i.basename(e);return(0,r.capitalize)((0,r.camelize)(t.slice(0,t.lastIndexOf(`.`))))}function s(e,t,n,r){let i=t.getProgram(),a=i.getSourceFile(n.fileName);if(a){let t=i.getTypeChecker(),n=c(e,a,r);if(n)return{node:n,type:t.getTypeAtLocation(n)}}}function c(e,t,n){let r;return i(t),r;function i(t){r||(e.isVariableDeclaration(t)&&t.name.getText()===n?r=t:t.forEachChild(i))}}}),s=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.getComponentDirectives=a;let n=t.require_language_core(),r=o(),i=new Set([`vBind`,`vIf`,`vOn`,`vOnce`,`vShow`,`vSlot`]);function a(e){let{typescript:t,language:a,languageService:o}=this,s=a.scripts.get(e),c=s?.generated?.root;if(!s?.generated||!(c instanceof n.VueVirtualCode))return[];let l=(0,r.getVariableType)(t,o,c,`__VLS_directives`);return l?l.type.getProperties().map(({name:e})=>e).filter(e=>e.startsWith(`v`)&&e.length>=2&&e[1]===e[1].toUpperCase()).filter(e=>!i.has(e)):[]}}),c=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.getComponentEvents=i;let n=t.require_language_core(),r=o();function i(e,t){let{typescript:i,language:a,languageService:o}=this,s=a.scripts.get(e),c=s?.generated?.root;if(!s?.generated||!(c instanceof n.VueVirtualCode))return[];let l=o.getProgram(),u=l.getTypeChecker(),d=(0,r.getVariableType)(i,o,c,`__VLS_components`);if(!d)return[];let f=(0,r.getComponentType)(i,o,c,d,e,t);if(!f)return[];let p=new Set;for(let e of f.getConstructSignatures()){let t=e.getReturnType(),n=t.getProperty(`$emit`);if(n){let e=u.getTypeOfSymbolAtLocation(n,d.node);for(let t of e.getCallSignatures()){let e=t.parameters[0];if(e){let t=u.getTypeOfSymbolAtLocation(e,d.node);t.isStringLiteral()&&p.add(t.value)}}}}return[...p]}}),l=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.getComponentNames=i;let n=t.require_language_core(),r=o();function i(e){let{typescript:t,language:i,languageService:a}=this,o=i.scripts.get(e),s=o?.generated?.root;if(!o?.generated||!(s instanceof n.VueVirtualCode))return[];let c=(0,r.getVariableType)(t,a,s,`__VLS_components`)?.type?.getProperties().map(e=>e.name).filter(e=>!e.includes(`$`)&&!e.startsWith(`_`))??[];return c.push((0,r.getSelfComponentName)(e)),c}}),u=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.getComponentProps=i;let n=t.require_language_core(),r=o();function i(e,t){let{typescript:i,language:o,languageService:s}=this,c=o.scripts.get(e),l=c?.generated?.root;if(!c?.generated||!(l instanceof n.VueVirtualCode))return[];let u=(0,r.getVariableType)(i,s,l,`__VLS_components`);if(!u)return[];let d=(0,r.getComponentType)(i,s,l,u,e,t);if(!d)return[];let f=new Map,p=s.getProgram(),m=p.getTypeChecker();for(let e of d.getCallSignatures()){let t=e.parameters[0];if(t){let e=m.getTypeOfSymbolAtLocation(t,u.node),n=e.getProperties();for(let e of n)h(e)}}for(let e of d.getConstructSignatures()){let t=e.getReturnType(),n=t.getProperty(`$props`);if(n){let e=m.getTypeOfSymbolAtLocation(n,u.node),t=e.getProperties();for(let e of t)h(e)}}return[...f.values()];function h(e){if(e.flags&i.SymbolFlags.Method)return;let t=e.name,n=!(e.flags&i.SymbolFlags.Optional)||void 0,{documentation:r,deprecated:o}=a(e.getDocumentationComment(m),e.getJsDocTags()),s=[],c=m.getTypeOfSymbol(e),l=c.types;if(l)for(let e of l){let t=e.value;t&&s.push(t)}let u;for(let{parent:t}of m.getRootSymbols(e).flatMap(e=>e.declarations??[])){if(!i.isInterfaceDeclaration(t))continue;let{text:e}=t.name;if(e.endsWith(`HTMLAttributes`)||e===`AriaAttributes`||e===`SVGAttributes`){u=!0;break}}f.set(t,{name:t,required:n,deprecated:o,isAttribute:u,documentation:r,values:s})}}function a(e,t){let n=s(e),r=c(t),i=[n,r].filter(e=>!!e).join(`

`),a=t.some(e=>e.name===`deprecated`);return{documentation:i,deprecated:a}}function s(e){return e.map(e=>{switch(e.kind){case`keyword`:return`\`${e.text}\``;case`functionName`:return`**${e.text}**`;default:return e.text}}).join(``)}function c(e){return e.map(e=>{let t=`*@${e.name}*`,n=e.text?.map(e=>e.kind===`parameterName`?`\`${e.text}\``:e.text).join(``)||``;return`${t} ${n}`}).join(`

`)}}),d=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.getComponentSlots=i;let n=t.require_language_core(),r=o();function i(e){let{typescript:t,language:i,languageService:a}=this,o=i.scripts.get(e),s=o?.generated?.root;if(!o?.generated||!(s instanceof n.VueVirtualCode))return[];let c=n.tsCodegen.get(s.sfc);if(!c)return[];let l=c.getSetupSlotsAssignName()??`__VLS_slots`,u=(0,r.getVariableType)(t,a,s,l);return u?u.type.getProperties().map(({name:e})=>e):[]}}),f=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.getElementAttrs=i;let n=t.require_language_core(),r=o();function i(e,t){let{typescript:i,language:a,languageService:o}=this,s=a.scripts.get(e),c=s?.generated?.root;if(!s?.generated||!(c instanceof n.VueVirtualCode))return[];let l=o.getProgram(),u=l.getTypeChecker(),d=(0,r.getVariableType)(i,o,c,`__VLS_elements`);if(!d)return[];let f=d.type.getProperty(t);if(!f)return[];let p=u.getTypeOfSymbol(f).getProperties();return p.map(e=>e.name)}}),p=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.getElementNames=i;let n=t.require_language_core(),r=o();function i(e){let{typescript:t,language:i,languageService:a}=this,o=i.scripts.get(e),s=o?.generated?.root;return!o?.generated||!(s instanceof n.VueVirtualCode)?[]:(0,r.getVariableType)(t,a,s,`__VLS_elements`)?.type?.getProperties().map(e=>e.name)??[]}}),m=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.getImportPathForFile=t;function t(e,t,n){let{typescript:r,languageService:i,languageServiceHost:a}=this,o=i.getProgram(),s=o?.getSourceFile(t),c=o?.getSourceFile(e);if(!o||!c||!s)return{};let l=r.moduleSpecifiers.getModuleSpecifiersWithCacheInfo,u=r.createModuleSpecifierResolutionHost(o,a),{moduleSpecifiers:d}=l(s.symbol,o.getTypeChecker(),a.getCompilationSettings(),c,u,n);return{path:d[0]}}}),h=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.getPropertiesAtLocation=r;let n=t.require_language_core();function r(e,t){let{languageService:r,language:i,typescript:a}=this,o=i.scripts.get(e),s=o?.generated?.root;if(!o?.generated||!(s instanceof n.VueVirtualCode))return[];let c=o.generated.languagePlugin.typescript?.getServiceScript(s);if(!c)return[];let l=!1;for(let[e,r]of i.maps.forEach(c.code)){for(let[e,i]of r.toGeneratedLocation(t))if((0,n.isCompletionEnabled)(i.data)){t=e,l=!0;break}if(l)break}if(!l)return[];t+=o.snapshot.getLength();let u=r.getProgram(),d=u.getSourceFile(e);if(!d)return[];let f=g(d,d,t);if(!f)return[];let p=u.getTypeChecker(),m=p.getTypeAtLocation(f),h=m.getProperties();return h.map(e=>e.name);function g(e,t,n){let r;return t.forEachChild(t=>{r||(t.end===n&&a.isIdentifier(t)?r=t:t.end>=n&&t.getStart(e)<n&&(r=g(e,t,n)))}),r}}});const g=r(),_=t.require_language_core(),v=i(),y=a(),b=s(),x=c(),S=l(),C=u(),w=d(),T=f(),E=p(),D=m(),O=h(),k=/\\/g,A=new WeakMap;module.exports=(0,g.createLanguageServicePlugin)((e,t)=>{let n=i();_.writeGlobalTypes(n,e.sys.writeFile);let r=_.createVueLanguagePlugin(e,t.languageServiceHost.getCompilationSettings(),n,e=>e);return a(),{languagePlugins:[r],setup:r=>{A.set(t.project,[r,t.languageServiceHost,t.languageService]),t.languageService=(0,v.createVueLanguageServiceProxy)(e,r,t.languageService,n);let i=setInterval(()=>{t.project.program&&(clearInterval(i),t.project.program.__vue__={language:r})},50)}};function i(){if(t.project.projectKind===e.server.ProjectKind.Configured){let n=t.project.getProjectName();return _.createParsedCommandLine(e,e.sys,n.replace(k,`/`)).vueOptions}else return _.createParsedCommandLineByJson(e,e.sys,t.languageServiceHost.getCurrentDirectory(),{}).vueOptions}function a(){let e=t.project.projectService;e.logger.info(`Vue: called handler processing `+t.project.projectKind);let n=t.session;if(n==null){e.logger.info(`Vue: there is no session in info.`);return}if(n.addProtocolHandler==null){e.logger.info(`Vue: there is no addProtocolHandler method.`);return}n.handlers.has(`_vue:projectInfo`)||(n.addProtocolHandler(`_vue:projectInfo`,({arguments:e})=>n.handlers.get(`projectInfo`)?.({arguments:e})),n.addProtocolHandler(`_vue:documentHighlights-full`,({arguments:e})=>n.handlers.get(`documentHighlights-full`)?.({arguments:e})),n.addProtocolHandler(`_vue:encodedSemanticClassifications-full`,({arguments:e})=>n.handlers.get(`encodedSemanticClassifications-full`)?.({arguments:e})),n.addProtocolHandler(`_vue:quickinfo`,({arguments:e})=>n.handlers.get(`quickinfo`)?.({arguments:e})),n.addProtocolHandler(`_vue:collectExtractProps`,({arguments:e})=>({response:y.collectExtractProps.apply(o(e[0]),e)})),n.addProtocolHandler(`_vue:getImportPathForFile`,({arguments:e})=>({response:D.getImportPathForFile.apply(o(e[0]),e)})),n.addProtocolHandler(`_vue:getPropertiesAtLocation`,({arguments:e})=>({response:O.getPropertiesAtLocation.apply(o(e[0]),e)})),n.addProtocolHandler(`_vue:getComponentDirectives`,({arguments:e})=>({response:b.getComponentDirectives.apply(o(e[0]),e)})),n.addProtocolHandler(`_vue:getComponentEvents`,({arguments:e})=>({response:x.getComponentEvents.apply(o(e[0]),e)})),n.addProtocolHandler(`_vue:getComponentNames`,({arguments:e})=>({response:S.getComponentNames.apply(o(e[0]),e)??[]})),n.addProtocolHandler(`_vue:getComponentProps`,({arguments:e})=>({response:C.getComponentProps.apply(o(e[0]),e)})),n.addProtocolHandler(`_vue:getComponentSlots`,({arguments:e})=>({response:w.getComponentSlots.apply(o(e[0]),e)})),n.addProtocolHandler(`_vue:getElementAttrs`,({arguments:e})=>({response:T.getElementAttrs.apply(o(e[0]),e)})),n.addProtocolHandler(`_vue:getElementNames`,({arguments:e})=>({response:E.getElementNames.apply(o(e[0]),e)})),e.logger.info(`Vue specific commands are successfully added.`))}function o(n){let r=t.session.getFileAndProject({file:n,projectFileName:void 0}),i=A.get(r.project);if(!i)throw`No RequestContext`;return{typescript:e,languageService:i[2],languageServiceHost:i[1],language:i[0]}}});